<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… ØªØ³Ø¹ÙŠØ± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© - Ø´Ø±ÙƒØ© Ø¹Ù„ÙŠ ÙÙ‡Ø¯ Ù…Ø³Ø¹ÙˆØ¯ Ù…Ø­Ø§Ø³Ø¨ÙˆÙ† ÙˆÙ…Ø±Ø§Ø¬Ø¹ÙˆÙ† Ù‚Ø§Ù†ÙˆÙ†ÙŠÙˆÙ†</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-gold: #C89F65;
            --secondary-gold: #D4AF6E;
            --accent-gold: #E5BE7C;
            --dark-bg: #2C3338;
            --darker-bg: #1F2327;
            --card-bg: #3A4048;
            --yellow-accent: #F4B942;
            --white: #FFFFFF;
            --text-light: #E8E8E8;
            --text-muted: #B8B8B8;
            --border-color: #4A5058;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', 'Tajawal', sans-serif;
            background: linear-gradient(135deg, var(--darker-bg) 0%, var(--dark-bg) 100%);
            color: var(--text-light);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(200, 159, 101, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(244, 185, 66, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        header {
            background: linear-gradient(135deg, var(--card-bg) 0%, var(--dark-bg) 100%);
            padding: 40px 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--primary-gold);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(200, 159, 101, 0.1) 0%, transparent 70%);
            animation: shimmer 8s infinite linear;
        }

        @keyframes shimmer {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        h1 {
            font-family: 'Cairo', sans-serif;
            font-size: 2.8em;
            text-align: center;
            background: linear-gradient(135deg, var(--accent-gold) 0%, var(--primary-gold) 50%, var(--secondary-gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 900;
            letter-spacing: 1px;
            position: relative;
            z-index: 1;
            animation: fadeInDown 1s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .subtitle {
            text-align: center;
            color: var(--secondary-gold);
            font-size: 1.2em;
            margin-top: 15px;
            position: relative;
            z-index: 1;
            animation: fadeIn 1.5s ease-out;
            font-weight: 600;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .admin-toggle {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--secondary-gold) 100%);
            color: var(--darker-bg);
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 700;
            box-shadow: 0 5px 20px rgba(200, 159, 101, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
            border: none;
            font-size: 1em;
        }

        .admin-toggle:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(200, 159, 101, 0.6);
        }

        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .auth-modal.active {
            display: flex;
        }

        .auth-box {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 20px;
            border: 2px solid var(--primary-gold);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            max-width: 450px;
            width: 90%;
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            min-width: 200px;
            padding: 18px 30px;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            font-size: 1.1em;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            color: var(--text-light);
        }

        .tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(200, 159, 101, 0.2), transparent);
            transition: left 0.6s;
        }

        .tab:hover::before {
            left: 100%;
        }

        .tab:hover {
            border-color: var(--primary-gold);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(200, 159, 101, 0.2);
        }

        .tab.active {
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--secondary-gold) 100%);
            border-color: var(--accent-gold);
            color: var(--darker-bg);
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(200, 159, 101, 0.4);
        }

        .tab-content {
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: var(--primary-gold);
            box-shadow: 0 12px 40px rgba(200, 159, 101, 0.15);
            transform: translateY(-5px);
        }

        .card-header {
            font-family: 'Cairo', sans-serif;
            font-size: 1.8em;
            color: var(--primary-gold);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary-gold);
            font-weight: 700;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            color: var(--secondary-gold);
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 0.95em;
        }

        input, select, textarea {
            padding: 14px;
            background: var(--darker-bg);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            color: var(--white);
            font-size: 1em;
            transition: all 0.3s ease;
            font-family: 'Tajawal', sans-serif;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-gold);
            background: var(--dark-bg);
            box-shadow: 0 0 20px rgba(200, 159, 101, 0.2);
        }

        input:hover, select:hover, textarea:hover {
            border-color: var(--secondary-gold);
        }

        button {
            padding: 16px 40px;
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--secondary-gold) 100%);
            color: var(--darker-bg);
            border: none;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 5px 20px rgba(200, 159, 101, 0.3);
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        button:hover::before {
            width: 300px;
            height: 300px;
        }

        button:hover {
            transform: translateY(-3px) scale(1.03);
            box-shadow: 0 10px 35px rgba(200, 159, 101, 0.5);
        }

        button:active {
            transform: translateY(-1px) scale(1.01);
        }

        button.secondary {
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--card-bg) 100%);
            color: var(--primary-gold);
            border: 2px solid var(--primary-gold);
        }

        button.danger {
            background: linear-gradient(135deg, #8B0000 0%, #DC143C 100%);
            color: var(--white);
        }

        .prediction-box {
            background: linear-gradient(135deg, rgba(200, 159, 101, 0.15) 0%, rgba(212, 175, 110, 0.15) 100%);
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            border: 2px solid var(--primary-gold);
            box-shadow: 0 5px 20px rgba(200, 159, 101, 0.2);
        }

        .prediction-title {
            color: var(--accent-gold);
            font-size: 1.4em;
            font-weight: 700;
            margin-bottom: 15px;
            font-family: 'Cairo', sans-serif;
        }

        .prediction-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-item {
            background: var(--darker-bg);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .stat-item:hover {
            border-color: var(--primary-gold);
            transform: translateY(-3px);
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.9em;
            margin-bottom: 8px;
        }

        .stat-value {
            color: var(--primary-gold);
            font-size: 1.6em;
            font-weight: 700;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: var(--darker-bg);
            border-radius: 10px;
            overflow: hidden;
        }

        th {
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--secondary-gold) 100%);
            color: var(--darker-bg);
            padding: 15px;
            text-align: right;
            font-weight: 700;
            font-size: 1.05em;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-light);
        }

        tr:hover {
            background: var(--card-bg);
        }

        .action-btn {
            padding: 8px 20px;
            font-size: 0.9em;
            margin: 0 5px;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-weight: 500;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .alert-success {
            background: linear-gradient(135deg, rgba(0, 128, 0, 0.2) 0%, rgba(0, 160, 0, 0.2) 100%);
            border: 1px solid #00a000;
            color: #90EE90;
        }

        .alert-error {
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.2) 0%, rgba(220, 20, 60, 0.2) 100%);
            border: 1px solid #DC143C;
            color: #FFB6C1;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
            background: var(--darker-bg);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
        }

        .export-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .hidden {
            display: none !important;
        }

        .admin-indicator {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary-gold);
            color: var(--darker-bg);
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 700;
            z-index: 1000;
            box-shadow: 0 5px 20px rgba(200, 159, 101, 0.4);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                min-width: 100%;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            button {
                width: 100%;
            }

            .export-buttons {
                flex-direction: column;
            }

            .admin-toggle {
                bottom: 20px;
                left: 20px;
                right: 20px;
                text-align: center;
            }
        }

        .section-title {
            color: var(--primary-gold);
            font-size: 1.3em;
            font-weight: 700;
            margin: 25px 0 15px;
            padding-right: 15px;
            border-right: 4px solid var(--primary-gold);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>âš–ï¸ Ù†Ø¸Ø§Ù… ØªØ³Ø¹ÙŠØ± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© âš–ï¸</h1>
            <p class="subtitle">Ø´Ø±ÙƒØ© Ø¹Ù„ÙŠ ÙÙ‡Ø¯ Ù…Ø³Ø¹ÙˆØ¯ Ù…Ø­Ø§Ø³Ø¨ÙˆÙ† ÙˆÙ…Ø±Ø§Ø¬Ø¹ÙˆÙ† Ù‚Ø§Ù†ÙˆÙ†ÙŠÙˆÙ†</p>
        </header>

        <!-- Admin Login Modal -->
        <div id="authModal" class="auth-modal">
            <div class="auth-box">
                <h2 class="card-header">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</h2>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                    <input type="text" id="adminUsername" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
                </div>
                <div class="form-group" style="margin-bottom: 20px;">
                    <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="adminPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                </div>
                <button onclick="adminLogin()" style="width: 100%; margin-bottom: 10px;">Ø¯Ø®ÙˆÙ„</button>
                <button class="secondary" onclick="closeAuthModal()" style="width: 100%;">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>

        <!-- Admin Indicator -->
        <div id="adminIndicator" class="admin-indicator hidden">
            ğŸ‘¨â€ğŸ’¼ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¯ÙŠØ±
            <button onclick="adminLogout()" style="padding: 5px 15px; margin-right: 10px; font-size: 0.9em;">Ø®Ø±ÙˆØ¬</button>
        </div>

        <!-- Main Application -->
        <div id="mainApp">
            <!-- Admin Toggle Button -->
            <button class="admin-toggle" onclick="showAuthModal()">ğŸ” Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</button>

            <!-- Tabs -->
            <div class="tabs">
                <div class="tab active" onclick="switchTab('calculator')">ğŸ§® Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªØ³Ø¹ÙŠØ±</div>
                <div class="tab admin-only hidden" onclick="switchTab('clients')">ğŸ“Š Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ù†ÙØ°ÙŠÙ†</div>
                <div class="tab admin-only hidden" onclick="switchTab('settings')">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
                <div class="tab admin-only hidden" onclick="switchTab('analytics')">ğŸ“ˆ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</div>
                <div class="tab admin-only hidden" onclick="switchTab('reports')">ğŸ“‘ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
            </div>

            <!-- Calculator Tab (Public) -->
            <div id="calculatorTab" class="tab-content active">
                <div class="card">
                    <h2 class="card-header">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªØ³Ø¹ÙŠØ± Ø§Ù„Ø°ÙƒÙŠØ©</h2>
                    
                    <h3 class="section-title">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                            <input type="text" id="calcClientName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©">
                        </div>
                        <div class="form-group">
                            <label>Ø³Ù†Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</label>
                            <input type="number" id="calcYear" value="2024">
                        </div>
                        <div class="form-group">
                            <label>Ø­Ø¬Ù… Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª (Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„)</label>
                            <input type="number" id="calcRevenue" step="0.1" placeholder="Ù…Ø«Ø§Ù„: 50">
                        </div>
                        <div class="form-group">
                            <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„ (Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„)</label>
                            <input type="number" id="calcAssets" step="0.1" placeholder="Ù…Ø«Ø§Ù„: 100">
                        </div>
                        <div class="form-group">
                            <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ø«Ø§Ø¨ØªØ© (Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„)</label>
                            <input type="number" id="calcFixedAssets" step="0.1" placeholder="Ù…Ø«Ø§Ù„: 30">
                        </div>
                        <div class="form-group">
                            <label>Ù†ÙˆØ¹ Ø§Ù„Ù†Ø´Ø§Ø·</label>
                            <select id="calcActivity">
                                <option value="ØªØ¬Ø§Ø±ÙŠ">ØªØ¬Ø§Ø±ÙŠ</option>
                                <option value="ØµÙ†Ø§Ø¹ÙŠ">ØµÙ†Ø§Ø¹ÙŠ</option>
                                <option value="Ø®Ø¯Ù…ÙŠ">Ø®Ø¯Ù…ÙŠ</option>
                                <option value="Ù…Ø§Ù„ÙŠ">Ù…Ø§Ù„ÙŠ</option>
                            </select>
                        </div>
                    </div>

                    <h3 class="section-title">Ø¹ÙˆØ§Ù…Ù„ Ø§Ù„ØªØ¹Ù‚ÙŠØ¯</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙŠÙ†ÙŠÙ† (Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„)</label>
                            <input type="number" id="calcReceivables" step="0.1" placeholder="Ù…Ø«Ø§Ù„: 20">
                        </div>
                        <div class="form-group">
                            <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø§Ø¦Ù†ÙŠÙ† (Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„)</label>
                            <input type="number" id="calcPayables" step="0.1" placeholder="Ù…Ø«Ø§Ù„: 15">
                        </div>
                        <div class="form-group">
                            <label>Ø¹Ø¯Ø¯ Ø§Ù„ÙØ±ÙˆØ¹</label>
                            <input type="number" id="calcBranches" value="1" min="1">
                        </div>
                        <div class="form-group">
                            <label>Ø¬ÙˆØ¯Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ</label>
                            <select id="calcSystemQuality">
                                <option value="Ø¶Ø¹ÙŠÙ">Ø¶Ø¹ÙŠÙ</option>
                                <option value="Ù…ØªÙˆØ³Ø·">Ù…ØªÙˆØ³Ø·</option>
                                <option value="Ù…Ù…ØªØ§Ø²">Ù…Ù…ØªØ§Ø²</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©</label>
                            <select id="calcInternalControl">
                                <option value="Ø¶Ø¹ÙŠÙ">Ø¶Ø¹ÙŠÙ</option>
                                <option value="Ù…ØªÙˆØ³Ø·">Ù…ØªÙˆØ³Ø·</option>
                                <option value="Ù‚ÙˆÙŠ">Ù‚ÙˆÙŠ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                            <select id="calcClientType">
                                <option value="Ø¬Ø¯ÙŠØ¯">Ø¬Ø¯ÙŠØ¯</option>
                                <option value="Ù…ØªÙƒØ±Ø±">Ù…ØªÙƒØ±Ø±</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ©</label>
                            <input type="number" id="calcBankAccounts" value="1" min="1">
                        </div>
                        <div class="form-group">
                            <label>Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¹Ù…Ù„Ø§Øª Ø£Ø¬Ù†Ø¨ÙŠØ©</label>
                            <select id="calcForeignCurrency">
                                <option value="Ù„Ø§">Ù„Ø§</option>
                                <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ø£Ø·Ø±Ø§Ù Ø°Ø§Øª Ø¹Ù„Ø§Ù‚Ø©</label>
                            <select id="calcRelatedParties">
                                <option value="Ù„Ø§">Ù„Ø§</option>
                                <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ÙˆØ¬ÙˆØ¯ Ù…Ø®Ø²ÙˆÙ†</label>
                            <select id="calcInventory">
                                <option value="Ù„Ø§">Ù„Ø§</option>
                                <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ù‚Ø±ÙˆØ¶ ÙˆØ§Ù„ØªÙ…ÙˆÙŠÙ„</label>
                            <select id="calcLoans">
                                <option value="Ù„Ø§">Ù„Ø§</option>
                                <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ù…Ø®ØµØµØ§Øª ÙˆØ§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ§Øª</label>
                            <select id="calcProvisions">
                                <option value="Ù„Ø§">Ù„Ø§</option>
                                <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø±Ø§Øª (IFRS 16)</label>
                            <select id="calcLeases">
                                <option value="Ù„Ø§">Ù„Ø§</option>
                                <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ù‚ÙˆØ¯ (IFRS 15)</label>
                            <select id="calcRevenueContracts">
                                <option value="Ù„Ø§">Ù„Ø§</option>
                                <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                            </select>
                        </div>
                    </div>

                    <button onclick="calculatePricing()" style="margin: 30px 0;">ğŸ”® Ø§Ø­Ø³Ø¨ Ø§Ù„ØªØ³Ø¹ÙŠØ±</button>

                    <div id="predictionResult"></div>

                    <div id="pricingSummary" class="prediction-box hidden">
                        <div class="prediction-title">Ù…Ù„Ø®Øµ Ø§Ù„ØªØ³Ø¹ÙŠØ±</div>
                        <div class="prediction-stats">
                            <div class="stat-item">
                                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</div>
                                <div class="stat-value" id="totalHours">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©</div>
                                <div class="stat-value" id="totalCost">0 Ø±ÙŠØ§Ù„</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­</div>
                                <div class="stat-value" id="totalPrice">0 Ø±ÙŠØ§Ù„</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­</div>
                                <div class="stat-value" id="profitMargin">0%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Clients Tab (Admin Only) -->
            <div id="clientsTab" class="tab-content">
                <div class="card">
                    <h2 class="card-header">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ù†ÙØ°ÙŠÙ†</h2>
                    
                    <button onclick="showAddClientForm()">â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>

                    <div id="addClientForm" class="hidden" style="margin-top: 30px;">
                        <h3 class="section-title">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>
                        
                        <h4 style="color: var(--secondary-gold); margin: 20px 0 10px;">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                                <input type="text" id="clientName">
                            </div>
                            <div class="form-group">
                                <label>Ø³Ù†Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</label>
                                <input type="number" id="clientYear" value="2024">
                            </div>
                            <div class="form-group">
                                <label>Ø­Ø¬Ù… Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª (Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„)</label>
                                <input type="number" id="clientRevenue" step="0.1">
                            </div>
                            <div class="form-group">
                                <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„ (Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„)</label>
                                <input type="number" id="clientAssets" step="0.1">
                            </div>
                            <div class="form-group">
                                <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ø«Ø§Ø¨ØªØ© (Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„)</label>
                                <input type="number" id="clientFixedAssets" step="0.1">
                            </div>
                            <div class="form-group">
                                <label>Ù†ÙˆØ¹ Ø§Ù„Ù†Ø´Ø§Ø·</label>
                                <select id="clientActivity">
                                    <option value="ØªØ¬Ø§Ø±ÙŠ">ØªØ¬Ø§Ø±ÙŠ</option>
                                    <option value="ØµÙ†Ø§Ø¹ÙŠ">ØµÙ†Ø§Ø¹ÙŠ</option>
                                    <option value="Ø®Ø¯Ù…ÙŠ">Ø®Ø¯Ù…ÙŠ</option>
                                    <option value="Ù…Ø§Ù„ÙŠ">Ù…Ø§Ù„ÙŠ</option>
                                </select>
                            </div>
                        </div>

                        <h4 style="color: var(--secondary-gold); margin: 20px 0 10px;">Ø¹ÙˆØ§Ù…Ù„ Ø§Ù„ØªØ¹Ù‚ÙŠØ¯</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙŠÙ†ÙŠÙ† (Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„)</label>
                                <input type="number" id="clientReceivables" step="0.1">
                            </div>
                            <div class="form-group">
                                <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø§Ø¦Ù†ÙŠÙ† (Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„)</label>
                                <input type="number" id="clientPayables" step="0.1">
                            </div>
                            <div class="form-group">
                                <label>Ø¹Ø¯Ø¯ Ø§Ù„ÙØ±ÙˆØ¹</label>
                                <input type="number" id="clientBranches" value="1" min="1">
                            </div>
                            <div class="form-group">
                                <label>Ø¬ÙˆØ¯Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ</label>
                                <select id="clientSystemQuality">
                                    <option value="Ø¶Ø¹ÙŠÙ">Ø¶Ø¹ÙŠÙ</option>
                                    <option value="Ù…ØªÙˆØ³Ø·">Ù…ØªÙˆØ³Ø·</option>
                                    <option value="Ù…Ù…ØªØ§Ø²">Ù…Ù…ØªØ§Ø²</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©</label>
                                <select id="clientInternalControl">
                                    <option value="Ø¶Ø¹ÙŠÙ">Ø¶Ø¹ÙŠÙ</option>
                                    <option value="Ù…ØªÙˆØ³Ø·">Ù…ØªÙˆØ³Ø·</option>
                                    <option value="Ù‚ÙˆÙŠ">Ù‚ÙˆÙŠ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                                <select id="clientType">
                                    <option value="Ø¬Ø¯ÙŠØ¯">Ø¬Ø¯ÙŠØ¯</option>
                                    <option value="Ù…ØªÙƒØ±Ø±">Ù…ØªÙƒØ±Ø±</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ©</label>
                                <input type="number" id="clientBankAccounts" value="1" min="1">
                            </div>
                            <div class="form-group">
                                <label>Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¹Ù…Ù„Ø§Øª Ø£Ø¬Ù†Ø¨ÙŠØ©</label>
                                <select id="clientForeignCurrency">
                                    <option value="Ù„Ø§">Ù„Ø§</option>
                                    <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ø£Ø·Ø±Ø§Ù Ø°Ø§Øª Ø¹Ù„Ø§Ù‚Ø©</label>
                                <select id="clientRelatedParties">
                                    <option value="Ù„Ø§">Ù„Ø§</option>
                                    <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>ÙˆØ¬ÙˆØ¯ Ù…Ø®Ø²ÙˆÙ†</label>
                                <select id="clientInventory">
                                    <option value="Ù„Ø§">Ù„Ø§</option>
                                    <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ù‚Ø±ÙˆØ¶ ÙˆØ§Ù„ØªÙ…ÙˆÙŠÙ„</label>
                                <select id="clientLoans">
                                    <option value="Ù„Ø§">Ù„Ø§</option>
                                    <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ù…Ø®ØµØµØ§Øª ÙˆØ§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ§Øª</label>
                                <select id="clientProvisions">
                                    <option value="Ù„Ø§">Ù„Ø§</option>
                                    <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø±Ø§Øª (IFRS 16)</label>
                                <select id="clientLeases">
                                    <option value="Ù„Ø§">Ù„Ø§</option>
                                    <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ù‚ÙˆØ¯ (IFRS 15)</label>
                                <select id="clientRevenueContracts">
                                    <option value="Ù„Ø§">Ù„Ø§</option>
                                    <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                                </select>
                            </div>
                        </div>

                        <h4 style="color: var(--secondary-gold); margin: 20px 0 10px;">Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ©</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø´Ø±ÙŠÙƒ</label>
                                <input type="number" id="clientPartnerHours" step="0.5">
                            </div>
                            <div class="form-group">
                                <label>Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¥Ø´Ø±Ø§Ù</label>
                                <input type="number" id="clientSupervisorHours" step="0.5">
                            </div>
                            <div class="form-group">
                                <label>Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„</label>
                                <input type="number" id="clientStaffHours" step="0.5">
                            </div>
                        </div>

                        <h4 style="color: var(--secondary-gold); margin: 20px 0 10px;">Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø­ØµÙ„ (Ø±ÙŠØ§Ù„)</label>
                                <input type="number" id="clientPrice">
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„ÙØ¹Ù„ÙŠØ© (Ø±ÙŠØ§Ù„)</label>
                                <input type="number" id="clientCost">
                            </div>
                        </div>

                        <div class="export-buttons">
                            <button onclick="saveClient()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¹Ù…ÙŠÙ„</button>
                            <button class="secondary" onclick="hideAddClientForm()">âœ–ï¸ Ø¥Ù„ØºØ§Ø¡</button>
                        </div>
                    </div>

                    <div id="clientsList" style="margin-top: 30px;"></div>
                </div>
            </div>

            <!-- Settings Tab (Admin Only) -->
            <div id="settingsTab" class="tab-content">
                <div class="card">
                    <h2 class="card-header">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ³Ø¹ÙŠØ±</h2>
                    
                    <h3 class="section-title">Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø§Øª</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Ø³Ø¹Ø± Ø³Ø§Ø¹Ø© Ø§Ù„Ø´Ø±ÙŠÙƒ (Ø±ÙŠØ§Ù„)</label>
                            <input type="number" id="settingPartnerRate" value="1000">
                        </div>
                        <div class="form-group">
                            <label>Ø³Ø¹Ø± Ø³Ø§Ø¹Ø© Ø§Ù„Ø¥Ø´Ø±Ø§Ù (Ø±ÙŠØ§Ù„)</label>
                            <input type="number" id="settingSupervisorRate" value="500">
                        </div>
                        <div class="form-group">
                            <label>Ø³Ø¹Ø± Ø³Ø§Ø¹Ø© Ø§Ù„Ø¹Ù…Ù„ (Ø±ÙŠØ§Ù„)</label>
                            <input type="number" id="settingStaffRate" value="200">
                        </div>
                    </div>

                    <h3 class="section-title">Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù (%)</label>
                            <input type="number" id="settingProfitMargin" value="30" min="0" max="100">
                        </div>
                    </div>

                    <button onclick="saveSettings()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                </div>
            </div>

            <!-- Analytics Tab (Admin Only) -->
            <div id="analyticsTab" class="tab-content">
                <div class="card">
                    <h2 class="card-header">Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h2>
                    
                    <div class="prediction-box">
                        <div class="prediction-title">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</div>
                        <div class="prediction-stats" id="generalStats"></div>
                    </div>

                    <div class="chart-container">
                        <canvas id="activityChart"></canvas>
                    </div>

                    <div class="chart-container">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Reports Tab (Admin Only) -->
            <div id="reportsTab" class="tab-content">
                <div class="card">
                    <h2 class="card-header">ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h2>
                    
                    <div class="export-buttons">
                        <button onclick="exportAllClientsReport()">ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</button>
                        <button onclick="exportAnalyticsReport()">ğŸ“ˆ ØªÙ‚Ø±ÙŠØ± ØªØ­Ù„ÙŠÙ„ÙŠ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let isAdmin = false;
        let clients = JSON.parse(localStorage.getItem('auditClients')) || [];
        let settings = JSON.parse(localStorage.getItem('auditSettings')) || {
            partnerRate: 1000,
            supervisorRate: 500,
            staffRate: 200,
            profitMargin: 30
        };

        // Initialize
        loadSettings();

        // Authentication
        function showAuthModal() {
            document.getElementById('authModal').classList.add('active');
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
        }

        function adminLogin() {
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;

            if (username === 'admin' && password === 'admin123') {
                isAdmin = true;
                document.getElementById('adminIndicator').classList.remove('hidden');
                document.querySelectorAll('.admin-only').forEach(el => el.classList.remove('hidden'));
                closeAuthModal();
                showAlert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                loadClientsList();
            } else {
                showAlert('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±', 'error');
            }
        }

        function adminLogout() {
            isAdmin = false;
            document.getElementById('adminIndicator').classList.add('hidden');
            document.querySelectorAll('.admin-only').forEach(el => el.classList.add('hidden'));
            switchTab('calculator');
            showAlert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'success');
        }

        // Tab Management
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            if (tabName === 'clients') loadClientsList();
            if (tabName === 'analytics') loadAnalytics();
            if (tabName === 'settings') loadSettingsForm();
        }

        // Calculator Functions
        function calculatePricing() {
            const revenue = parseFloat(document.getElementById('calcRevenue').value) || 0;
            const assets = parseFloat(document.getElementById('calcAssets').value) || 0;
            const fixedAssets = parseFloat(document.getElementById('calcFixedAssets').value) || 0;
            const receivables = parseFloat(document.getElementById('calcReceivables').value) || 0;
            const payables = parseFloat(document.getElementById('calcPayables').value) || 0;
            const activity = document.getElementById('calcActivity').value;
            const branches = parseInt(document.getElementById('calcBranches').value) || 1;
            const systemQuality = document.getElementById('calcSystemQuality').value;
            const internalControl = document.getElementById('calcInternalControl').value;
            const clientType = document.getElementById('calcClientType').value;
            const bankAccounts = parseInt(document.getElementById('calcBankAccounts').value) || 1;
            const foreignCurrency = document.getElementById('calcForeignCurrency').value === 'Ù†Ø¹Ù…';
            const relatedParties = document.getElementById('calcRelatedParties').value === 'Ù†Ø¹Ù…';
            const inventory = document.getElementById('calcInventory').value === 'Ù†Ø¹Ù…';
            const loans = document.getElementById('calcLoans').value === 'Ù†Ø¹Ù…';
            const provisions = document.getElementById('calcProvisions').value === 'Ù†Ø¹Ù…';
            const leases = document.getElementById('calcLeases').value === 'Ù†Ø¹Ù…';
            const revenueContracts = document.getElementById('calcRevenueContracts').value === 'Ù†Ø¹Ù…';

            if (revenue === 0 || assets === 0) {
                showAlert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ø£ØµÙˆÙ„', 'error');
                return;
            }

            // Filter similar clients
            const similarClients = clients.filter(client => {
                const revenueDiff = Math.abs(client.revenue - revenue) / revenue;
                const assetsDiff = Math.abs(client.assets - assets) / assets;
                return client.activity === activity && 
                       revenueDiff < 0.3 && 
                       assetsDiff < 0.3;
            });

            let partnerHours, supervisorHours, staffHours;

            if (similarClients.length === 0) {
                // Base prediction
                let baseHours = 40;
                
                if (revenue > 100) baseHours += 30;
                else if (revenue > 50) baseHours += 20;
                else if (revenue > 20) baseHours += 10;
                
                if (assets > 200) baseHours += 25;
                else if (assets > 100) baseHours += 15;
                else if (assets > 50) baseHours += 10;
                
                if (activity === 'Ù…Ø§Ù„ÙŠ') baseHours += 30;
                else if (activity === 'ØµÙ†Ø§Ø¹ÙŠ') baseHours += 20;
                
                // Fixed Assets factor
                if (fixedAssets > 50) baseHours += 20;
                else if (fixedAssets > 20) baseHours += 12;
                else if (fixedAssets > 10) baseHours += 8;
                
                // Receivables factor
                if (receivables > 30) baseHours += 15;
                else if (receivables > 15) baseHours += 10;
                else if (receivables > 5) baseHours += 6;
                
                // Payables factor
                if (payables > 30) baseHours += 12;
                else if (payables > 15) baseHours += 8;
                else if (payables > 5) baseHours += 5;
                
                baseHours += (branches - 1) * 5;
                if (systemQuality === 'Ø¶Ø¹ÙŠÙ') baseHours += 20;
                else if (systemQuality === 'Ù…ØªÙˆØ³Ø·') baseHours += 10;
                if (internalControl === 'Ø¶Ø¹ÙŠÙ') baseHours += 15;
                else if (internalControl === 'Ù…ØªÙˆØ³Ø·') baseHours += 8;
                if (clientType === 'Ø¬Ø¯ÙŠØ¯') baseHours += 15;
                baseHours += (bankAccounts - 1) * 3;
                if (foreignCurrency) baseHours += 10;
                if (relatedParties) baseHours += 12;
                if (inventory) baseHours += 15;
                if (loans) baseHours += 12;
                if (provisions) baseHours += 10;
                if (leases) baseHours += 18;
                if (revenueContracts) baseHours += 16;

                partnerHours = Math.round(baseHours * 0.15);
                supervisorHours = Math.round(baseHours * 0.25);
                staffHours = baseHours - partnerHours - supervisorHours;

                document.getElementById('predictionResult').innerHTML = `
                    <div class="prediction-box">
                        <div class="prediction-title">ğŸ”® Ø§Ù„ØªÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</div>
                        <div class="prediction-stats">
                            <div class="stat-item">
                                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©</div>
                                <div class="stat-value">${baseHours} Ø³Ø§Ø¹Ø©</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</div>
                                <div class="stat-value">${Math.round(baseHours * 0.8)} - ${Math.round(baseHours * 1.2)} Ø³Ø§Ø¹Ø©</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø´Ø§Ø¨Ù‡ÙŠÙ†</div>
                                <div class="stat-value">0 Ø¹Ù…ÙŠÙ„</div>
                            </div>
                        </div>
                        <div style="margin-top: 15px; color: var(--secondary-gold); font-size: 0.95em;">
                            â„¹ï¸ Ø§Ù„ØªÙˆÙ‚Ø¹ Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ. ${isAdmin ? 'Ø£Ø¶Ù Ø¹Ù…Ù„Ø§Ø¡ Ù…Ù†ÙØ°ÙŠÙ† Ù…Ø´Ø§Ø¨Ù‡ÙŠÙ† Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¯Ù‚Ø©.' : ''}
                        </div>
                    </div>
                `;
            } else {
                // Calculate averages from similar clients
                const avgPartner = similarClients.reduce((sum, c) => sum + c.partnerHours, 0) / similarClients.length;
                const avgSupervisor = similarClients.reduce((sum, c) => sum + c.supervisorHours, 0) / similarClients.length;
                const avgStaff = similarClients.reduce((sum, c) => sum + c.staffHours, 0) / similarClients.length;
                const avgTotal = avgPartner + avgSupervisor + avgStaff;
                
                const minTotal = Math.min(...similarClients.map(c => c.partnerHours + c.supervisorHours + c.staffHours));
                const maxTotal = Math.max(...similarClients.map(c => c.partnerHours + c.supervisorHours + c.staffHours));

                partnerHours = Math.round(avgPartner);
                supervisorHours = Math.round(avgSupervisor);
                staffHours = Math.round(avgStaff);

                const accuracy = similarClients.length >= 5 ? 'Ø¹Ø§Ù„ÙŠØ©' : similarClients.length >= 3 ? 'Ø¬ÙŠØ¯Ø©' : 'Ù…ØªÙˆØ³Ø·Ø©';
                
                document.getElementById('predictionResult').innerHTML = `
                    <div class="prediction-box">
                        <div class="prediction-title">ğŸ¯ Ø§Ù„ØªÙˆÙ‚Ø¹ Ø§Ù„Ø°ÙƒÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ©</div>
                        <div class="prediction-stats">
                            <div class="stat-item">
                                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©</div>
                                <div class="stat-value">${Math.round(avgTotal)} Ø³Ø§Ø¹Ø©</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</div>
                                <div class="stat-value">${Math.round(minTotal)} - ${Math.round(maxTotal)} Ø³Ø§Ø¹Ø©</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Ø¯Ù‚Ø© Ø§Ù„ØªÙˆÙ‚Ø¹</div>
                                <div class="stat-value">${accuracy}</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø´Ø§Ø¨Ù‡ÙŠÙ†</div>
                                <div class="stat-value">${similarClients.length} Ø¹Ù…ÙŠÙ„</div>
                            </div>
                        </div>
                        <div style="margin-top: 15px; color: var(--secondary-gold);">
                            <strong>ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø³Ø§Ø¹Ø§Øª:</strong><br>
                            Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø´Ø±ÙŠÙƒ: ${Math.round(avgPartner)} | Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¥Ø´Ø±Ø§Ù: ${Math.round(avgSupervisor)} | Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„: ${Math.round(avgStaff)}
                        </div>
                    </div>
                `;
            }

            // Calculate pricing
            const totalHours = partnerHours + supervisorHours + staffHours;
            const totalCost = (partnerHours * settings.partnerRate) + 
                            (supervisorHours * settings.supervisorRate) + 
                            (staffHours * settings.staffRate);
            const totalPrice = totalCost * (1 + settings.profitMargin / 100);
            const profitMargin = settings.profitMargin;

            document.getElementById('totalHours').textContent = totalHours;
            document.getElementById('totalCost').textContent = totalCost.toLocaleString() + ' Ø±ÙŠØ§Ù„';
            document.getElementById('totalPrice').textContent = Math.round(totalPrice).toLocaleString() + ' Ø±ÙŠØ§Ù„';
            document.getElementById('profitMargin').textContent = profitMargin + '%';
            document.getElementById('pricingSummary').classList.remove('hidden');
        }

        // Client Management
        function showAddClientForm() {
            document.getElementById('addClientForm').classList.remove('hidden');
        }

        function hideAddClientForm() {
            document.getElementById('addClientForm').classList.add('hidden');
        }

        function saveClient() {
            const clientName = document.getElementById('clientName').value;
            if (!clientName) {
                showAlert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„', 'error');
                return;
            }

            const partnerHours = parseFloat(document.getElementById('clientPartnerHours').value) || 0;
            const supervisorHours = parseFloat(document.getElementById('clientSupervisorHours').value) || 0;
            const staffHours = parseFloat(document.getElementById('clientStaffHours').value) || 0;
            const price = parseFloat(document.getElementById('clientPrice').value) || 0;
            const cost = parseFloat(document.getElementById('clientCost').value) || 0;

            const client = {
                id: Date.now(),
                name: clientName,
                year: document.getElementById('clientYear').value,
                revenue: parseFloat(document.getElementById('clientRevenue').value) || 0,
                assets: parseFloat(document.getElementById('clientAssets').value) || 0,
                fixedAssets: parseFloat(document.getElementById('clientFixedAssets').value) || 0,
                receivables: parseFloat(document.getElementById('clientReceivables').value) || 0,
                payables: parseFloat(document.getElementById('clientPayables').value) || 0,
                activity: document.getElementById('clientActivity').value,
                branches: parseInt(document.getElementById('clientBranches').value) || 1,
                systemQuality: document.getElementById('clientSystemQuality').value,
                internalControl: document.getElementById('clientInternalControl').value,
                clientType: document.getElementById('clientType').value,
                bankAccounts: parseInt(document.getElementById('clientBankAccounts').value) || 1,
                foreignCurrency: document.getElementById('clientForeignCurrency').value,
                relatedParties: document.getElementById('clientRelatedParties').value,
                inventory: document.getElementById('clientInventory').value,
                loans: document.getElementById('clientLoans').value,
                provisions: document.getElementById('clientProvisions').value,
                leases: document.getElementById('clientLeases').value,
                revenueContracts: document.getElementById('clientRevenueContracts').value,
                partnerHours,
                supervisorHours,
                staffHours,
                totalHours: partnerHours + supervisorHours + staffHours,
                price,
                cost,
                profit: price - cost,
                profitMargin: price > 0 ? ((price - cost) / price * 100).toFixed(1) : 0
            };

            clients.push(client);
            localStorage.setItem('auditClients', JSON.stringify(clients));
            showAlert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            hideAddClientForm();
            loadClientsList();
        }

        function loadClientsList() {
            if (clients.length === 0) {
                document.getElementById('clientsList').innerHTML = '<p style="color: var(--primary-gold); text-align: center; padding: 30px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ù†ÙØ°ÙŠÙ† Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>';
                return;
            }

            let html = '<table><thead><tr><th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th><th>Ø§Ù„Ø³Ù†Ø©</th><th>Ø§Ù„Ù†Ø´Ø§Ø·</th><th>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª (Ù….Ø±)</th><th>Ø§Ù„Ø£ØµÙˆÙ„ (Ù….Ø±)</th><th>Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ø«Ø§Ø¨ØªØ© (Ù….Ø±)</th><th>Ø§Ù„Ù…Ø¯ÙŠÙ†ÙŠÙ† (Ù….Ø±)</th><th>Ø§Ù„Ø¯Ø§Ø¦Ù†ÙŠÙ† (Ù….Ø±)</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­</th><th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead><tbody>';
            
            clients.forEach(client => {
                html += `
                    <tr>
                        <td>${client.name}</td>
                        <td>${client.year}</td>
                        <td>${client.activity}</td>
                        <td>${client.revenue.toFixed(1)}</td>
                        <td>${client.assets.toFixed(1)}</td>
                        <td>${(client.fixedAssets || 0).toFixed(1)}</td>
                        <td>${(client.receivables || 0).toFixed(1)}</td>
                        <td>${(client.payables || 0).toFixed(1)}</td>
                        <td>${client.totalHours}</td>
                        <td>${client.price.toLocaleString()} Ø±ÙŠØ§Ù„</td>
                        <td>${client.profitMargin}%</td>
                        <td>
                            <button class="action-btn danger" onclick="deleteClient(${client.id})">Ø­Ø°Ù</button>
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            document.getElementById('clientsList').innerHTML = html;
        }

        function deleteClient(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„ØŸ')) {
                clients = clients.filter(c => c.id !== id);
                localStorage.setItem('auditClients', JSON.stringify(clients));
                loadClientsList();
                showAlert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }
        }

        // Settings
        function loadSettings() {
            settings = JSON.parse(localStorage.getItem('auditSettings')) || {
                partnerRate: 1000,
                supervisorRate: 500,
                staffRate: 200,
                profitMargin: 30
            };
        }

        function loadSettingsForm() {
            document.getElementById('settingPartnerRate').value = settings.partnerRate;
            document.getElementById('settingSupervisorRate').value = settings.supervisorRate;
            document.getElementById('settingStaffRate').value = settings.staffRate;
            document.getElementById('settingProfitMargin').value = settings.profitMargin;
        }

        function saveSettings() {
            settings = {
                partnerRate: parseFloat(document.getElementById('settingPartnerRate').value) || 1000,
                supervisorRate: parseFloat(document.getElementById('settingSupervisorRate').value) || 500,
                staffRate: parseFloat(document.getElementById('settingStaffRate').value) || 200,
                profitMargin: parseFloat(document.getElementById('settingProfitMargin').value) || 30
            };
            localStorage.setItem('auditSettings', JSON.stringify(settings));
            showAlert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        }

        // Analytics
        function loadAnalytics() {
            if (clients.length === 0) {
                document.getElementById('generalStats').innerHTML = '<p style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ© Ù„Ù„ØªØ­Ù„ÙŠÙ„</p>';
                return;
            }

            const avgHours = clients.reduce((sum, c) => sum + c.totalHours, 0) / clients.length;
            const avgPrice = clients.reduce((sum, c) => sum + c.price, 0) / clients.length;
            const avgProfit = clients.reduce((sum, c) => sum + c.profit, 0) / clients.length;
            const avgMargin = clients.reduce((sum, c) => sum + parseFloat(c.profitMargin), 0) / clients.length;

            document.getElementById('generalStats').innerHTML = `
                <div class="stat-item">
                    <div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</div>
                    <div class="stat-value">${clients.length}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø§Ø¹Ø§Øª</div>
                    <div class="stat-value">${avgHours.toFixed(1)}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø¹Ø±</div>
                    <div class="stat-value">${avgPrice.toLocaleString()} Ø±ÙŠØ§Ù„</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø¨Ø­</div>
                    <div class="stat-value">${avgProfit.toLocaleString()} Ø±ÙŠØ§Ù„</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Ù…ØªÙˆØ³Ø· Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­</div>
                    <div class="stat-value">${avgMargin.toFixed(1)}%</div>
                </div>
            `;

            // Activity Chart
            const activityData = {};
            clients.forEach(c => {
                if (!activityData[c.activity]) activityData[c.activity] = [];
                activityData[c.activity].push(c.totalHours);
            });

            const activityLabels = Object.keys(activityData);
            const activityAvg = activityLabels.map(a => 
                activityData[a].reduce((sum, h) => sum + h, 0) / activityData[a].length
            );

            const ctx1 = document.getElementById('activityChart').getContext('2d');
            new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: activityLabels,
                    datasets: [{
                        label: 'Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù†Ø´Ø§Ø·',
                        data: activityAvg,
                        backgroundColor: ['#C89F65', '#D4AF6E', '#E5BE7C', '#F4B942']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: '#E8E8E8' } }
                    },
                    scales: {
                        y: { ticks: { color: '#E8E8E8' }, grid: { color: '#4A5058' } },
                        x: { ticks: { color: '#E8E8E8' }, grid: { color: '#4A5058' } }
                    }
                }
            });

            // Revenue Chart
            const revenueRanges = {'0-20': [], '20-50': [], '50-100': [], '100+': []};
            clients.forEach(c => {
                if (c.revenue < 20) revenueRanges['0-20'].push(c.totalHours);
                else if (c.revenue < 50) revenueRanges['20-50'].push(c.totalHours);
                else if (c.revenue < 100) revenueRanges['50-100'].push(c.totalHours);
                else revenueRanges['100+'].push(c.totalHours);
            });

            const revenueAvg = Object.keys(revenueRanges).map(r => 
                revenueRanges[r].length > 0 ? 
                revenueRanges[r].reduce((sum, h) => sum + h, 0) / revenueRanges[r].length : 0
            );

            const ctx2 = document.getElementById('revenueChart').getContext('2d');
            new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: ['0-20 Ù…Ù„ÙŠÙˆÙ†', '20-50 Ù…Ù„ÙŠÙˆÙ†', '50-100 Ù…Ù„ÙŠÙˆÙ†', '+100 Ù…Ù„ÙŠÙˆÙ†'],
                    datasets: [{
                        label: 'Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø­Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª',
                        data: revenueAvg,
                        borderColor: '#C89F65',
                        backgroundColor: 'rgba(200, 159, 101, 0.2)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: '#E8E8E8' } }
                    },
                    scales: {
                        y: { ticks: { color: '#E8E8E8' }, grid: { color: '#4A5058' } },
                        x: { ticks: { color: '#E8E8E8' }, grid: { color: '#4A5058' } }
                    }
                }
            });
        }

        // PDF Export
        function exportAllClientsReport() {
            if (clients.length === 0) {
                showAlert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù„ØªØµØ¯ÙŠØ± ØªÙ‚Ø±ÙŠØ±Ù‡Ù…', 'error');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.setFontSize(18);
            doc.setTextColor(200, 159, 101);
            doc.text('All Clients Report', 105, 20, { align: 'center' });

            const tableData = clients.map(c => [
                c.name, c.year, c.activity, c.revenue.toFixed(1), 
                c.totalHours, c.price.toLocaleString(), `${c.profitMargin}%`
            ]);

            doc.autoTable({
                startY: 30,
                head: [['Client', 'Year', 'Activity', 'Revenue', 'Hours', 'Price', 'Margin']],
                body: tableData,
                theme: 'grid',
                headStyles: { fillColor: [200, 159, 101], textColor: [0, 0, 0] }
            });

            doc.save('all_clients_report.pdf');
            showAlert('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }

        function exportAnalyticsReport() {
            if (clients.length === 0) {
                showAlert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ© Ù„Ù„ØªØµØ¯ÙŠØ±', 'error');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.setFontSize(18);
            doc.setTextColor(200, 159, 101);
            doc.text('Analytics Report', 105, 20, { align: 'center' });

            const avgHours = clients.reduce((sum, c) => sum + c.totalHours, 0) / clients.length;
            const avgPrice = clients.reduce((sum, c) => sum + c.price, 0) / clients.length;
            const avgProfit = clients.reduce((sum, c) => sum + c.profit, 0) / clients.length;

            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text(`Total Clients: ${clients.length}`, 20, 40);
            doc.text(`Average Hours: ${avgHours.toFixed(1)}`, 20, 50);
            doc.text(`Average Price: ${avgPrice.toLocaleString()} SAR`, 20, 60);
            doc.text(`Average Profit: ${avgProfit.toLocaleString()} SAR`, 20, 70);

            doc.save('analytics_report.pdf');
            showAlert('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }

        // Utilities
        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            
            document.querySelector('.container').insertBefore(alertDiv, document.querySelector('.container').firstChild);
            
            setTimeout(() => alertDiv.remove(), 3000);
        }
    </script>
</body>
</html>
